System.register(["jimu-core","jimu-arcgis"],(function(t,e){var n={},o={};return{setters:[function(t){n.DataSourceComponent=t.DataSourceComponent,n.FormattedMessage=t.FormattedMessage,n.React=t.React,n.jsx=t.jsx,n.loadArcGISJSAPIModules=t.loadArcGISJSAPIModules},function(t){o.JimuMapViewComponent=t.JimuMapViewComponent}],execute:function(){t((()=>{var t={56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,o=0;o<e.length;o++)if(e[o].identifier===t){n=o;break}return n}function o(t,o){for(var r={},l=[],a=0;a<t.length;a++){var s=t[a],c=o.base?s[0]+o.base:s[0],d=r[c]||0,u="".concat(c," ").concat(d);r[c]=d+1;var p=n(u),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)e[p].references++,e[p].updater(f);else{var m=i(f,o);o.byIndex=a,e.splice(a,0,{identifier:u,updater:m,references:1})}l.push(u)}return l}function i(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var r=o(t=t||[],i=i||{});return function(t){t=t||[];for(var l=0;l<r.length;l++){var a=n(r[l]);e[a].references--}for(var s=o(t,i),c=0;c<r.length;c++){var d=n(r[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}r=s}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},244:t=>{"use strict";t.exports=n},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",o=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),o&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),o&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,o,i,r){"string"==typeof t&&(t=[[null,t,void 0]]);var l={};if(o)for(var a=0;a<this.length;a++){var s=this[a][0];null!=s&&(l[s]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);o&&l[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),e.push(d))}},e}},400:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var o=n(601),i=n.n(o),r=n(314),l=n.n(r)()(i());l.push([t.id,'.parking-lot-widget{padding:16px;font-family:"Avenir Next","Helvetica Neue",Arial,sans-serif}.widget-header{margin-bottom:16px}.widget-header h3{margin:0;font-size:18px;font-weight:600;color:#323232}.widget-content{min-height:100px}.parking-lot-list{display:flex;flex-direction:column;gap:12px}.parking-lot-item{background:white;border-radius:8px;padding:10px 12px;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1);border:1px solid #e0e0e0}.parking-lot-content{display:flex;align-items:center;gap:12px;margin-bottom:2px}.utilization-dot{width:20px;height:20px;border-radius:50%;flex-shrink:0;border:2px solid white;box-shadow:0 1px 3px rgba(0, 0, 0, 0.2)}.parking-lot-name{font-size:16px;font-weight:700;color:#323232;line-height:1.3;display:flex;align-items:center}.utilization-text{font-size:14px;color:#666;font-weight:400;margin-left:32px}.no-data{text-align:center;color:#999;font-style:italic;padding:20px;background:#f8f8f8;border-radius:8px;border:1px dashed #ccc}.loading{text-align:center;color:#666;padding:20px;background:#f8f8f8;border-radius:8px;border:1px solid #e0e0e0}@media(max-width: 480px){.parking-lot-widget{padding:12px}.parking-lot-item{padding:10px}.parking-lot-name{font-size:14px}.utilization-text{font-size:12px}}.parking-lot-item:hover{box-shadow:0 4px 12px rgba(0, 0, 0, 0.15);transform:translateY(-1px);transition:all .2s ease}.parking-lot-widget.loading{opacity:.6;pointer-events:none}.parking-lot-widget.loading::after{content:"";position:absolute;top:50%;left:50%;width:20px;height:20px;margin:-10px 0 0 -10px;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}',""]);const a=l},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},659:t=>{"use strict";var e={};t.exports=function(t,n){var o=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},686:t=>{"use strict";t.exports=o},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(o,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={id:n,exports:{}};return t[n](r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="",i.nc=void 0;var r={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(r),i.d(r,{__set_webpack_public_path__:()=>F,default:()=>N});var t=i(244),e=i(686),n=i(72),o=i.n(n),l=i(825),a=i.n(l),s=i(659),c=i.n(s),d=i(56),u=i.n(d),p=i(540),f=i.n(p),m=i(113),g=i.n(m),h=i(400),v={};v.styleTagTransform=g(),v.setAttributes=u(),v.insert=c().bind(null,"head"),v.domAPI=a(),v.insertStyleElement=f();o()(h.A,v);h.A&&h.A.locals&&h.A.locals;const x="Please configure a data source in the widget settings";var y=function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function l(t){try{s(o.next(t))}catch(t){r(t)}}function a(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,a)}s((o=o.apply(t,e||[])).next())}))};const b="http://www.w3.org/2000/svg",A=50,w=46,S=(t,e,n,o)=>{const i=Math.PI/180*o;return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}},k=(t,e,n,o,i)=>{const r=o+i,l=S(t,e,n,o),a=S(t,e,n,r),s=i>180?"1":"0";return["M",l.x.toFixed(2),l.y.toFixed(2),"A",n.toFixed(2),n.toFixed(2),"0",s,"1",a.x.toFixed(2),a.y.toFixed(2)].join(" ")},C=(t,e,n,o,i)=>{const r=S(t,e,n,o),l=S(t,e,n,o+i),a=i>180?"1":"0";return["M",t.toFixed(2),e.toFixed(2),"L",r.x.toFixed(2),r.y.toFixed(2),"A",n.toFixed(2),n.toFixed(2),"0",a,"1",l.x.toFixed(2),l.y.toFixed(2),"Z"].join(" ")},N=n=>{const{config:o,id:i,useDataSources:r,useMapWidgetIds:l}=n;t.React.useEffect((()=>{}),[i,r,l]);const[a,s]=t.React.useState(null),[c,d]=t.React.useState([]),[u,p]=t.React.useState(null),[f,m]=t.React.useState(null),[g,h]=t.React.useState(null),[v,S]=t.React.useState(!1),N=t.React.useRef(null),F=t.React.useRef([]),M=t.React.useRef(null),E=t.React.useRef(!1);t.React.useEffect((()=>{if(a&&c.length>0){const t=()=>{const t=a.view.zoom,e=Math.max(.3,Math.min(1,(t-10)/8));c.forEach((t=>{try{const n=a.view.toScreen(t.geometry);if(t.element){t.element.style.transform=`scale(${e})`,t.element.style.transformOrigin="20px bottom";const o=t.element.offsetHeight||60;t.element.style.left=n.x-20+"px",t.element.style.top=n.y-o-8+"px"}}catch(t){}}))},e=[a.view.watch("extent",t),a.view.watch("center",t),a.view.watch("zoom",t)];return t(),()=>{e.forEach((t=>{t&&"function"==typeof t.remove&&t.remove()}))}}}),[a,c]),t.React.useEffect((()=>()=>{c.forEach((t=>{t.element&&t.element.parentNode&&t.element.parentNode.removeChild(t.element)}))}),[c]),t.React.useEffect((()=>{document.querySelectorAll(".parking-lot-map-label").forEach((t=>{t.parentNode&&t.parentNode.removeChild(t)})),d([]),m(null)}),[o.parkingLotField,o.utilizationField,o.showUtilizationText,o.allowNegatives,o.fullThreshold]),t.React.useEffect((()=>{if(!r||0===r.length)return void m(null);const t=r[0].dataSourceId;if(null!==f&&t!==f){document.querySelectorAll(".parking-lot-map-label").forEach((t=>{t.parentNode&&t.parentNode.removeChild(t)})),d([]),M.current=null,E.current=!1}f!==t&&m(t)}),[r,f]),t.React.useEffect((()=>{var t,e,n;if(!N.current||!(null===(t=null==a?void 0:a.view)||void 0===t?void 0:t.ready)||!f)return;const i=N.current,l=null===(e=null==r?void 0:r[0])||void 0===e?void 0:e.dataSourceId;if(!l||f!==l||"LOADED"!==i.getStatus())return;let s="";const c=t=>{try{return t&&0!==t.length?t.map((t=>{var e,n,i,r,l,a,s,c,d;try{let u,p,f,m;return"function"==typeof(null==t?void 0:t.getId)?(u=t.getId()||"unknown",p=(null===(n=(e=t).getData)||void 0===n?void 0:n.call(e))||{}):(null==t?void 0:t.feature)?(u=(null===(r=null===(i=t.feature)||void 0===i?void 0:i.attributes)||void 0===r?void 0:r.OBJECTID)||(null===(a=null===(l=t.feature)||void 0===l?void 0:l.attributes)||void 0===a?void 0:a.FID)||"unknown",p=(null===(s=t.feature)||void 0===s?void 0:s.attributes)||{}):(null==t?void 0:t.attributes)?(u=(null===(c=t.attributes)||void 0===c?void 0:c.OBJECTID)||(null===(d=t.attributes)||void 0===d?void 0:d.FID)||"unknown",p=t.attributes||{}):(u="unknown",p={}),f=String(p[o.parkingLotField]||""),m=Number(p[o.utilizationField]||0),`${u}:${f}:${m}`}catch(t){return""}})).filter(Boolean).sort().join("|"):"empty"}catch(t){return"error"}};null===(n=null==i?void 0:i.getAutoRefreshInterval)||void 0===n||n.call(i);y(void 0,void 0,void 0,(function*(){var t;try{const e={returnGeometry:!0,outFields:["*"],pageSize:1e3},n=yield null===(t=null==i?void 0:i.query)||void 0===t?void 0:t.call(i,e),o=(null==n?void 0:n.records)||[];o&&o.length>0&&(s=c(o),o.length)}catch(t){}}));const d=setInterval((()=>{try{if("LOADED"!==i.getStatus())return void i.getStatus();const t={returnGeometry:!0,outFields:["*"],pageSize:1e3};y(void 0,void 0,void 0,(function*(){var e;try{const n=yield null===(e=null==i?void 0:i.query)||void 0===e?void 0:e.call(i,t),o=(null==n?void 0:n.records)||[];if(!o||0===o.length)return;const r=c(o);null==o||o.length,s.length,r.length,s.substring(0,50),r.substring(0,50),r!==s&&""!==s&&"error"!==r?(null==o||o.length,S(!0),E.current=!1,s=r):""===s&&(r.length,o.length,s=r)}catch(t){}}))}catch(t){}}),3e4);return()=>{clearInterval(d)}}),[N.current,a,f,o.parkingLotField,o.utilizationField,r]);const I=t=>{var e;const n=Math.max(0,Math.min(100,null!==(e=o.fullThreshold)&&void 0!==e?e:95));let i=100-t;if(!o.allowNegatives&&i<0&&(i=0),t>=n||i<=Math.max(0,100-n))return"Full";const r=Math.max(0,Math.min(100,i));return`${Math.round(r)}% Available`},z=(t,e)=>{const n=100-Math.max(0,Math.min(100,t)),o=Math.min(n/100*360,359.999),i=document.createElement("div");i.style.cssText="\n      width: 44px;\n      height: 44px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-shrink: 0;\n      pointer-events: none;\n    ",i.setAttribute("aria-hidden","true");const r=document.createElementNS(b,"svg");r.setAttribute("width","44"),r.setAttribute("height","44"),r.setAttribute("viewBox","0 0 100 100"),r.style.display="block",r.style.flexShrink="0",r.style.pointerEvents="none",r.setAttribute("role","presentation"),r.setAttribute("focusable","false");const l=document.createElementNS(b,"circle");if(l.setAttribute("cx",A.toFixed(2)),l.setAttribute("cy",A.toFixed(2)),l.setAttribute("r",w.toFixed(2)),l.setAttribute("fill","#8B8B8B"),l.setAttribute("stroke","none"),r.appendChild(l),n>0)if(n>=99.5){const t=document.createElementNS(b,"circle");t.setAttribute("cx",A.toFixed(2)),t.setAttribute("cy",A.toFixed(2)),t.setAttribute("r",(w-3).toFixed(2)),t.setAttribute("fill",e),t.setAttribute("stroke","none"),r.appendChild(t)}else{const t=document.createElementNS(b,"path");t.setAttribute("d",C(A,A,w-3,-90,o)),t.setAttribute("fill",e),t.setAttribute("stroke","none"),r.appendChild(t);const n=document.createElementNS(b,"path");n.setAttribute("d",k(A,A,w-3,-90,o)),n.setAttribute("fill","none"),n.setAttribute("stroke",e),n.setAttribute("stroke-width","3.5"),r.appendChild(n)}const a=document.createElementNS(b,"circle");return a.setAttribute("cx",A.toFixed(2)),a.setAttribute("cy",A.toFixed(2)),a.setAttribute("r",(w-1.5).toFixed(2)),a.setAttribute("fill","none"),a.setAttribute("stroke","#333333"),a.setAttribute("stroke-width","3"),r.appendChild(a),i.appendChild(r),i};return(0,t.jsx)("div",{className:"parking-lot-widget jimu-widget","data-widget-id":i,style:{width:"100%",height:"100%",overflow:"hidden",position:"relative"}},l&&l.length>0&&(0,t.jsx)(e.JimuMapViewComponent,{useMapWidgetId:l[0],onActiveViewChange:t=>{if(t){s(t);let e=document.querySelector(`[data-widget-id="${null==l?void 0:l[0]}"] .map-root`);if(e||(e=document.querySelector(`[data-widget-id="${null==l?void 0:l[0]}"] .esri-view`),e||(e=document.querySelector(`[data-widget-id="${null==l?void 0:l[0]}"] .esri-view-root`)),e||(e=document.querySelector(`[data-widget-id="${null==l?void 0:l[0]}"]`))),e)p(e);else{const t=document.querySelector(".esri-view-root");t&&p(t)}}}}),r&&r.length>0&&u?(0,t.jsx)(t.DataSourceComponent,{useDataSource:r[0],widgetId:i,query:{},queryAll:!0,onDataSourceInfoChange:(t,e)=>{if(t&&void 0!==t.sourceVersion){if(e&&t.sourceVersion!==e.sourceVersion){document.querySelectorAll(".parking-lot-map-label").forEach((t=>{t.parentNode&&t.parentNode.removeChild(t)})),d([]),h(t.sourceVersion),S(!0)}else null===g&&h(t.sourceVersion)}},onQueryRequired:(t,e)=>{var n;if(t&&e){const o=null===(n=r[0])||void 0===n?void 0:n.dataSourceId;if(o&&t[o]&&e[o]){const n=t[o].sourceVersion;n!==e[o].sourceVersion&&(S(!0),h(n))}}}},(e=>{var n,i,l;if(null===(n=null==e?void 0:e.getStatus)||void 0===n||n.call(e),null===(i=null==r?void 0:r[0])||void 0===i||i.dataSourceId,!e)return N.current=null,null;if(N.current=e,e.id,e.type,e.getStatus(),"LOADED"===e.getStatus()){const n=r[0].dataSourceId,i=document.querySelectorAll(".parking-lot-map-label").length,s=(M.current,E.current),p=0===i,m=v,g=f===n,h=null===(l=null==a?void 0:a.view)||void 0===l?void 0:l.ready,x=!s&&(p||m)&&g&&h;if(c.length,M.current,x){E.current=!0;const i={returnGeometry:!0,outFields:["*"],pageSize:1e3};y(void 0,void 0,void 0,(function*(){var r;try{const l=yield null===(r=null==e?void 0:e.query)||void 0===r?void 0:r.call(e,i),s=(null==l?void 0:l.records)||[];if(s&&s.length>0){const e=s.map((t=>(null==t?void 0:t.feature)?t.feature:"function"==typeof(null==t?void 0:t.getJSAPIGraphic)?null:"function"==typeof(null==t?void 0:t.getJSAPIGeometry)?{geometry:t.getJSAPIGeometry(),attributes:t.getData()}:null)).filter((t=>t));if(e.length>0)if(m&&!p)try{yield(t=>y(void 0,void 0,void 0,(function*(){if(null==t||t.length,!u||!a)return;const e=u.querySelectorAll(".parking-lot-map-label"),n=new Map,i=new Set;e.forEach((t=>{const e=t.getAttribute("data-parking-lot-id");e&&n.set(e,t)})),n.size,t.length;for(const e of t){let t,r=null;if("function"==typeof e.getData){t=e.getData();try{if("function"==typeof e.getJSAPIGeometry)r=e.getJSAPIGeometry();else if("function"==typeof e.getGeometry){const t=e.getGeometry();t&&(r=t)}}catch(t){continue}}else e.attributes&&e.geometry?(t=e.attributes,r=e.geometry):(t=e.data||e.attributes||e,r=e.geometry||e.geom||null);const l=null==t?void 0:t[o.parkingLotField],s=null==t?void 0:t[o.utilizationField];if(!r||!l)continue;const c=String(l);i.add(c);const d=n.get(c);if(!d)continue;const u=Number(s),p=Number.isFinite(u)?u:0,f="#D5A0E3",m=I(p),g=o.showUtilizationText?m:"";let h=100-p;!o.allowNegatives&&h<0&&(h=0);const v=Math.max(0,Math.min(100,h));try{const t=a.view.toScreen(r),e=t.x-50+"px",n=t.y-30+"px";d.style.left!==e&&(d.style.left=e),d.style.top!==n&&(d.style.top=n)}catch(t){}d.setAttribute("aria-label",`${l}: ${m}`);const x=Array.from(d.children),y=x[0],S=x[1];if(y){const t=y.querySelector("svg");if(t){const e=100-Math.max(0,Math.min(100,v)),n=Math.min(e/100*360,359.999),o=Array.from(t.children);for(let e=o.length-2;e>=1;e--)t.removeChild(o[e]);if(e>0)if(e>=99.5){const e=document.createElementNS(b,"circle");e.setAttribute("cx",A.toFixed(2)),e.setAttribute("cy",A.toFixed(2)),e.setAttribute("r",(w-3).toFixed(2)),e.setAttribute("fill",f),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild)}else{const e=document.createElementNS(b,"path");e.setAttribute("d",C(A,A,w-3,-90,n)),e.setAttribute("fill",f),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild);const o=document.createElementNS(b,"path");o.setAttribute("d",k(A,A,w-3,-90,n)),o.setAttribute("fill","none"),o.setAttribute("stroke",f),o.setAttribute("stroke-width","3.5"),t.insertBefore(o,t.lastChild)}}}if(S){const t=Array.from(S.children);let e=o.showUtilizationText?0:-1,n=o.showUtilizationText?1:0;if(o.showUtilizationText&&e>=0&&t[e]){const n=t[e];n.textContent!==g&&(n.textContent=g)}if(t[n]){const e=t[n];e.textContent!==l&&(e.textContent=l)}}}n.forEach(((t,e)=>{i.has(e)||t.parentNode&&t.parentNode.removeChild(t)})),i.size,n.size,i.size})))(e),S(!1),E.current=!1}catch(t){S(!1),E.current=!1}else e.length,null==u||u.tagName,setTimeout((()=>y(void 0,void 0,void 0,(function*(){try{yield(e=>y(void 0,void 0,void 0,(function*(){var n,i,r,l,s,c,p;if(null==e||e.length,!u||!a)return;let f=null,m=null;try{const e=yield(0,t.loadArcGISJSAPIModules)(["esri/geometry/projection","esri/geometry/Point","esri/geometry/SpatialReference"]);f=e[0],m=e[1],e[2],yield f.load()}catch(t){}const g=new Set,h=[],v=new Map,x=u?u.querySelectorAll(".parking-lot-map-label"):document.querySelectorAll(".parking-lot-map-label");x.length,x.forEach((t=>{const e=t.getAttribute("data-parking-lot-id");e&&v.set(e,t)})),v.size,Array.from(v.keys());let y={};e.length>0&&(e[0],Object.keys(e[0]||{}),null===(n=e[0])||void 0===n||n.getData,null===(i=e[0])||void 0===i||i.getJSAPIGeometry,null===(r=e[0])||void 0===r||r.getGeometry,null===(l=e[0])||void 0===l||l.attributes,null===(s=e[0])||void 0===s||s.geometry,null===(p=null===(c=e[0])||void 0===c?void 0:c.constructor)||void 0===p||p.name);for(const t of e){let e,n=null;if("function"==typeof t.getData){e=t.getData();try{if("function"==typeof t.getJSAPIGeometry)n=t.getJSAPIGeometry();else if("function"==typeof t.getGeometry){const e=t.getGeometry();e&&(n=e)}}catch(t){}}else t.attributes&&t.geometry?(e=t.attributes,n=t.geometry):(Object.keys(t||{}),e=t.data||t.attributes||t,n=t.geometry||t.geom||null);const i=null==e?void 0:e[o.parkingLotField],r=null==e?void 0:e[o.utilizationField];if(!n){y.noGeometry=(y.noGeometry||0)+1,t.getData,t.getJSAPIGeometry,t.getGeometry,t.geometry,t.attributes,Object.keys(t||{});continue}if(!i){y.noName=(y.noName||0)+1;continue}const l=Number(r),s=Number.isFinite(l)?l:0,c="#D5A0E3",d=I(s),p=o.showUtilizationText?d:"";let m=100-s;!o.allowNegatives&&m<0&&(m=0);const x=Math.max(0,Math.min(100,m)),S=String(i);g.add(S);try{const t=a.view.spatialReference,e=n.spatialReference;if(f&&e&&t&&e.wkid!==t.wkid){const e=f.project(n,t);e&&(n=e)}}catch(t){}let N;try{N=a.view.toScreen(n)}catch(t){y.coordError=(y.coordError||0)+1;continue}let F=v.get(S);const M=!F;if(v.size,F){const t=N.x-50+"px",r=N.y-30+"px";F.style.left!==t&&(F.style.left=t),F.style.top!==r&&(F.style.top=r),F.setAttribute("aria-label",`${i}: ${d}`);const l=Array.from(F.children),a=l[0],s=l[1];if(a){const t=a.querySelector("svg");if(t){const e=100-Math.max(0,Math.min(100,x)),n=Math.min(e/100*360,359.999),o=Array.from(t.children);for(let e=o.length-2;e>=1;e--)t.removeChild(o[e]);if(e>0)if(e>=99.5){const e=document.createElementNS(b,"circle");e.setAttribute("cx",A.toFixed(2)),e.setAttribute("cy",A.toFixed(2)),e.setAttribute("r",(w-3).toFixed(2)),e.setAttribute("fill",c),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild)}else{const e=document.createElementNS(b,"path");e.setAttribute("d",C(A,A,w-3,-90,n)),e.setAttribute("fill",c),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild);const o=document.createElementNS(b,"path");o.setAttribute("d",k(A,A,w-3,-90,n)),o.setAttribute("fill","none"),o.setAttribute("stroke",c),o.setAttribute("stroke-width","3.5"),t.insertBefore(o,t.lastChild)}}}if(s){const t=Array.from(s.children);let e=o.showUtilizationText?0:-1,n=o.showUtilizationText?1:0;if(o.showUtilizationText&&e>=0&&t[e]){const n=t[e];n.textContent!==p&&(n.textContent=p)}if(t[n]){const e=t[n];e.textContent!==i&&(e.textContent=i)}}h.push({element:F,geometry:n,data:e});continue}F=document.createElement("div"),F.className="parking-lot-map-label",F.setAttribute("role","img"),F.setAttribute("aria-label",`${i}: ${d}`),F.setAttribute("tabindex","-1"),F.setAttribute("data-parking-lot-id",S),F.style.cssText=`\n        position: absolute;\n        left: ${N.x-50}px;\n        top: ${N.y-30}px;\n        background: white;\n        border-radius: 12px;\n        padding: 8px 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        border: 1px solid #d0d0d0;\n        font-family: 'Avenir Next', 'Helvetica Neue', Arial, sans-serif;\n        z-index: 1000;\n        pointer-events: none;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        min-width: 150px;\n      `;const E=document.createElement("div");E.style.cssText="\n        position: absolute;\n        bottom: -8px;\n        left: 20px;\n        width: 0;\n        height: 0;\n        border-left: 8px solid transparent;\n        border-right: 8px solid transparent;\n        border-top: 8px solid white;\n        z-index: 1001;\n      ";const T=document.createElement("div");T.style.cssText="\n        position: absolute;\n        bottom: -9px;\n        left: 20px;\n        width: 0;\n        height: 0;\n        border-left: 9px solid transparent;\n        border-right: 9px solid transparent;\n        border-top: 9px solid #d0d0d0;\n        z-index: 1000;\n      ";const R=z(x,c),j=document.createElement("div");if(j.style.cssText="\n        display: flex;\n        flex-direction: column;\n        gap: 1px;\n      ",o.showUtilizationText){const t=document.createElement("div");t.textContent=p,t.style.cssText="\n          font-size: 16px;\n          color: #000000;\n          line-height: 1.2;\n          font-weight: 900;\n        ",j.appendChild(t)}const D=document.createElement("div");if(D.textContent=i,D.style.cssText="\n        font-size: 13px;\n        font-weight: 700;\n        color: #000000;\n        line-height: 1.2;\n      ",j.appendChild(D),F.appendChild(R),F.appendChild(j),F.appendChild(T),F.appendChild(E),F.childNodes.length,M)try{u.appendChild(F)}catch(t){continue}else F.childNodes.length,j.textContent;h.push({element:F,geometry:n,data:e})}v.forEach(((t,e)=>{g.has(e)||t.parentNode&&t.parentNode.removeChild(t)})),document.querySelectorAll(".parking-lot-map-label").length,h.length,h.filter((t=>!v.has(t.element.getAttribute("data-parking-lot-id")||""))).length,h.filter((t=>v.has(t.element.getAttribute("data-parking-lot-id")||""))).length,u&&u.tagName,e.length,F.current=h,d(h)})))(e);const i=document.querySelectorAll(".parking-lot-map-label").length;e.length,i>0?M.current=n:((null==u?void 0:u.parentNode)&&u.parentNode.tagName,E.current=!1)}catch(t){E.current=!1}}))),500);else E.current=!1}else E.current=!1}catch(t){E.current=!1}}))}}return null})):null,l&&0!==l.length?r&&0!==r.length?null:(0,t.jsx)("div",{className:"no-data"},(0,t.jsx)(t.FormattedMessage,{id:"configureDataSource",defaultMessage:x})):(0,t.jsx)("div",{className:"no-data"},(0,t.jsx)(t.FormattedMessage,{id:"selectMap",defaultMessage:"Please select a map widget in the settings"})))};function F(t){i.p=t}})(),r})())}}}));