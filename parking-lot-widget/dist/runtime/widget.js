System.register(["jimu-core","jimu-arcgis"],(function(t,e){var n={},r={};return{setters:[function(t){n.DataSourceComponent=t.DataSourceComponent,n.FormattedMessage=t.FormattedMessage,n.React=t.React,n.jsx=t.jsx,n.loadArcGISJSAPIModules=t.loadArcGISJSAPIModules},function(t){r.JimuMapViewComponent=t.JimuMapViewComponent}],execute:function(){t((()=>{var t={56:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},a=[],l=0;l<t.length;l++){var s=t[l],c=r.base?s[0]+r.base:s[0],u=o[c]||0,d="".concat(c," ").concat(u);o[c]=u+1;var p=n(d),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)e[p].references++,e[p].updater(f);else{var m=i(f,r);r.byIndex=l,e.splice(l,0,{identifier:d,updater:m,references:1})}a.push(d)}return a}function i(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var l=n(o[a]);e[l].references--}for(var s=r(t,i),c=0;c<o.length;c++){var u=n(o[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=s}}},113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},244:t=>{"use strict";t.exports=n},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(a[s]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);r&&a[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),e.push(u))}},e}},400:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(601),i=n.n(r),o=n(314),a=n.n(o)()(i());a.push([t.id,'.parking-lot-widget{padding:16px;font-family:"Avenir Next","Helvetica Neue",Arial,sans-serif}.widget-header{margin-bottom:16px}.widget-header h3{margin:0;font-size:18px;font-weight:600;color:#323232}.widget-content{min-height:100px}.parking-lot-list{display:flex;flex-direction:column;gap:12px}.parking-lot-item{background:white;border-radius:8px;padding:10px 12px;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1);border:1px solid #e0e0e0}.parking-lot-content{display:flex;align-items:center;gap:12px;margin-bottom:2px}.utilization-dot{width:20px;height:20px;border-radius:50%;flex-shrink:0;border:2px solid white;box-shadow:0 1px 3px rgba(0, 0, 0, 0.2)}.parking-lot-name{font-size:16px;font-weight:700;color:#323232;line-height:1.3;display:flex;align-items:center}.utilization-text{font-size:14px;color:#666;font-weight:400;margin-left:32px}.no-data{text-align:center;color:#999;font-style:italic;padding:20px;background:#f8f8f8;border-radius:8px;border:1px dashed #ccc}.loading{text-align:center;color:#666;padding:20px;background:#f8f8f8;border-radius:8px;border:1px solid #e0e0e0}@media(max-width: 480px){.parking-lot-widget{padding:12px}.parking-lot-item{padding:10px}.parking-lot-name{font-size:14px}.utilization-text{font-size:12px}}.parking-lot-item:hover{box-shadow:0 4px 12px rgba(0, 0, 0, 0.15);transform:translateY(-1px);transition:all .2s ease}.parking-lot-widget.loading{opacity:.6;pointer-events:none}.parking-lot-widget.loading::after{content:"";position:absolute;top:50%;left:50%;width:20px;height:20px;margin:-10px 0 0 -10px;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}',""]);const l=a},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{"use strict";t.exports=function(t){return t[1]}},659:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},686:t=>{"use strict";t.exports=r},825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={id:n,exports:{}};return t[n](o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="",i.nc=void 0;var o={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(o),i.d(o,{__set_webpack_public_path__:()=>N,default:()=>M});var t=i(244),e=i(686),n=i(72),r=i.n(n),a=i(825),l=i.n(a),s=i(659),c=i.n(s),u=i(56),d=i.n(u),p=i(540),f=i.n(p),m=i(113),h=i.n(m),g=i(400),x={};x.styleTagTransform=h(),x.setAttributes=d(),x.insert=c().bind(null,"head"),x.domAPI=l(),x.insertStyleElement=f();r()(g.A,x);g.A&&g.A.locals&&g.A.locals;const v="Please configure a data source in the widget settings";var b=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function l(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,l)}s((r=r.apply(t,e||[])).next())}))};const y="http://www.w3.org/2000/svg",A=50,w=46,S=(t,e,n,r)=>{const i=Math.PI/180*r;return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}},k=(t,e,n,r,i)=>{const o=r+i,a=S(t,e,n,r),l=S(t,e,n,o),s=Math.abs(i)>180?"1":"0",c=i<0?"0":"1";return["M",a.x.toFixed(2),a.y.toFixed(2),"A",n.toFixed(2),n.toFixed(2),"0",s,c,l.x.toFixed(2),l.y.toFixed(2)].join(" ")},C=(t,e,n,r,i)=>{const o=S(t,e,n,r),a=S(t,e,n,r+i),l=Math.abs(i)>180?"1":"0",s=i<0?"0":"1";return["M",t.toFixed(2),e.toFixed(2),"L",o.x.toFixed(2),o.y.toFixed(2),"A",n.toFixed(2),n.toFixed(2),"0",l,s,a.x.toFixed(2),a.y.toFixed(2),"Z"].join(" ")},M=n=>{const{config:r,id:i,useDataSources:o,useMapWidgetIds:a}=n,[l,s]=t.React.useState(null),[c,u]=t.React.useState([]),[d,p]=t.React.useState(null),[f,m]=t.React.useState(null),[h,g]=t.React.useState(!1),x=t.React.useRef(null),S=t.React.useRef([]),M=t.React.useRef(null),N=t.React.useRef(!1),E=t.React.useRef(!1),F=t.React.useRef(null),z=t.React.useRef(0),R=t.React.useCallback((t=>{if(!t)return;t.querySelectorAll(".parking-lot-map-label").forEach((t=>{t.parentNode&&t.parentNode.removeChild(t)}))}),[]),T=t.React.useCallback((t=>{var e;if(!t)return null;if(null==t?void 0:t.feature)return t.feature;if("function"==typeof(null==t?void 0:t.getJSAPIGeometry)){const n=t.getJSAPIGeometry(),r=(null===(e=t.getData)||void 0===e?void 0:e.call(t))||{};if(n)return{geometry:n,attributes:r}}return(null==t?void 0:t.attributes)&&(null==t?void 0:t.geometry)?t:null}),[]);t.React.useEffect((()=>{if(l&&c.length>0){const t=()=>{const t=l.view.zoom,e=Math.max(.3,Math.min(1,(t-10)/8));c.forEach((t=>{try{const n=l.view.toScreen(t.geometry);if(t.element){t.element.style.transform=`scale(${e})`,t.element.style.transformOrigin="20px bottom";const r=t.element.offsetHeight||60;t.element.style.left=n.x-20+"px",t.element.style.top=n.y-r-8+"px"}}catch(t){}}))},e=[l.view.watch("extent",t),l.view.watch("center",t),l.view.watch("zoom",t)];return t(),()=>{e.forEach((t=>{t&&"function"==typeof t.remove&&t.remove()}))}}}),[l,c]),t.React.useEffect((()=>()=>{c.forEach((t=>{t.element&&t.element.parentNode&&t.element.parentNode.removeChild(t.element)}))}),[c]),t.React.useEffect((()=>{R(d),u([]),m(null),g(!0),M.current=null,N.current=!1,E.current=!1,F.current=null}),[R,d,r.parkingLotField,r.utilizationField,r.showUtilizationText,r.allowNegatives,r.fullThreshold,r.availableColor,r.unavailableColor]),t.React.useEffect((()=>{if(!o||0===o.length)return m(null),g(!1),void(F.current=null);const t=o[0].dataSourceId;null!==f&&t!==f&&(R(d),u([]),M.current=null,N.current=!1,E.current=!1,F.current=null,g(!0)),f!==t&&m(t)}),[o,f,R,d]);const I=t.React.useCallback((()=>{const t=Date.now();t-z.current<750||(z.current=t,g(!0))}),[]);t.React.useEffect((()=>{var t,e;if(!(null===(t=null==l?void 0:l.view)||void 0===t?void 0:t.ready)||!f||!d)return;const n=x.current,r=null===(e=null==o?void 0:o[0])||void 0===e?void 0:e.dataSourceId;if(!n||"LOADED"!==n.getStatus()||!r||f!==r)return;if(N.current||E.current)return;0!==d.querySelectorAll(".parking-lot-map-label").length||h||I()}),[l,f,d,o,h,I]),t.React.useEffect((()=>{var t,e;if(!(h&&(null===(t=null==l?void 0:l.view)||void 0===t?void 0:t.ready)&&f&&d))return;const n=x.current,r=null===(e=null==o?void 0:o[0])||void 0===e?void 0:e.dataSourceId;if(!n||"LOADED"!==n.getStatus()||!r||f!==r)return;if(N.current||E.current)return;let i=!1;return N.current=!0,E.current=!0,b(void 0,void 0,void 0,(function*(){var t;try{const e=(null===(t=null==n?void 0:n.getRecords)||void 0===t?void 0:t.call(n))||[];if(!e||0===e.length)return void g(!1);const o=e.slice(0,1e3).map((t=>T(t))).filter((t=>t));if(i)return;if(0===o.length)return void g(!1);const a=d.querySelectorAll(".parking-lot-map-label").length;0===a?(yield P(o),d.querySelectorAll(".parking-lot-map-label").length>0&&(M.current=r)):yield G(o),g(!1)}catch(t){g(!1)}finally{N.current=!1,E.current=!1}})),()=>{i=!0}}),[h,l,f,o,d,r.parkingLotField,r.utilizationField,r.showUtilizationText,r.allowNegatives,r.fullThreshold,r.availableColor,r.unavailableColor,T]);const j=t=>{var e;const n=Math.max(0,Math.min(100,null!==(e=r.fullThreshold)&&void 0!==e?e:95));let i=100-t;if(!r.allowNegatives&&i<0&&(i=0),t>=n||i<=Math.max(0,100-n))return"Full";const o=Math.max(0,Math.min(100,i));return`${Math.round(o)}% Available`},D=(t,e,n)=>{const r=Math.max(0,Math.min(100,t)),i=-Math.min(r/100*360,359.999),o=document.createElement("div");o.style.cssText="\n      width: 44px;\n      height: 44px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-shrink: 0;\n      pointer-events: none;\n    ",o.setAttribute("aria-hidden","true");const a=document.createElementNS(y,"svg");a.setAttribute("width","44"),a.setAttribute("height","44"),a.setAttribute("viewBox","0 0 100 100"),a.style.display="block",a.style.flexShrink="0",a.style.pointerEvents="none",a.setAttribute("role","presentation"),a.setAttribute("focusable","false");const l=document.createElementNS(y,"circle");if(l.setAttribute("cx",A.toFixed(2)),l.setAttribute("cy",A.toFixed(2)),l.setAttribute("r",w.toFixed(2)),l.setAttribute("fill",n),l.setAttribute("stroke","none"),a.appendChild(l),r>0)if(r>=99.5){const t=document.createElementNS(y,"circle");t.setAttribute("cx",A.toFixed(2)),t.setAttribute("cy",A.toFixed(2)),t.setAttribute("r",(w-3).toFixed(2)),t.setAttribute("fill",e),t.setAttribute("stroke","none"),a.appendChild(t)}else{const t=document.createElementNS(y,"path");t.setAttribute("d",C(A,A,w-3,-90,i)),t.setAttribute("fill",e),t.setAttribute("stroke","none"),a.appendChild(t);const n=document.createElementNS(y,"path");n.setAttribute("d",k(A,A,w-3,-90,i)),n.setAttribute("fill","none"),n.setAttribute("stroke",e),n.setAttribute("stroke-width","3.5"),a.appendChild(n)}const s=document.createElementNS(y,"circle");return s.setAttribute("cx",A.toFixed(2)),s.setAttribute("cy",A.toFixed(2)),s.setAttribute("r",(w-1.5).toFixed(2)),s.setAttribute("fill","none"),s.setAttribute("stroke","#333333"),s.setAttribute("stroke-width","3"),a.appendChild(s),o.appendChild(a),o},P=e=>b(void 0,void 0,void 0,(function*(){var n,i,o,a,s,c,p;if(null==e||e.length,!d||!l)return;let f=null,m=null;try{const e=yield(0,t.loadArcGISJSAPIModules)(["esri/geometry/projection","esri/geometry/Point","esri/geometry/SpatialReference"]);f=e[0],m=e[1];e[2];yield f.load()}catch(t){}const h=new Set,g=[],x=new Map,v=d.querySelectorAll(".parking-lot-map-label");v.length,v.forEach((t=>{const e=t.getAttribute("data-parking-lot-id");e&&x.set(e,t)})),x.size,Array.from(x.keys());let b={};e.length>0&&(e[0],Object.keys(e[0]||{}),null===(n=e[0])||void 0===n||n.getData,null===(i=e[0])||void 0===i||i.getJSAPIGeometry,null===(o=e[0])||void 0===o||o.getGeometry,null===(a=e[0])||void 0===a||a.attributes,null===(s=e[0])||void 0===s||s.geometry,null===(p=null===(c=e[0])||void 0===c?void 0:c.constructor)||void 0===p||p.name);for(const t of e){let e,n=null;if("function"==typeof t.getData){e=t.getData();try{if("function"==typeof t.getJSAPIGeometry)n=t.getJSAPIGeometry();else if("function"==typeof t.getGeometry){const e=t.getGeometry();e&&(n=e)}}catch(t){}}else t.attributes&&t.geometry?(e=t.attributes,n=t.geometry):(Object.keys(t||{}),e=t.data||t.attributes||t,n=t.geometry||t.geom||null);const i=null==e?void 0:e[r.parkingLotField],o=null==e?void 0:e[r.utilizationField];if(!n){b.noGeometry=(b.noGeometry||0)+1,t.getData,t.getJSAPIGeometry,t.getGeometry,t.geometry,t.attributes,Object.keys(t||{});continue}if(!i){b.noName=(b.noName||0)+1;continue}const a=Number(o),s=Number.isFinite(a)?a:0,c=r.availableColor||"#E683DD",u=r.unavailableColor||"#8B8B8B",p=j(s),m=r.showUtilizationText?p:"";let v=100-s;!r.allowNegatives&&v<0&&(v=0);const S=Math.max(0,Math.min(100,v)),M=String(i);h.add(M);try{const t=l.view.spatialReference,e=n.spatialReference;if(f&&e&&t&&e.wkid!==t.wkid){const e=f.project(n,t);e&&(n=e)}}catch(t){}let N;try{N=l.view.toScreen(n)}catch(t){b.coordError=(b.coordError||0)+1;continue}let E=x.get(M);const F=!E;if(x.size,E){const t=N.x-50+"px",o=N.y-30+"px";E.style.left!==t&&(E.style.left=t),E.style.top!==o&&(E.style.top=o),E.setAttribute("aria-label",`${i}: ${p}`);const a=Array.from(E.children),l=a[0],s=a[1];if(l){const t=l.querySelector("svg");if(t){const e=Math.max(0,Math.min(100,S)),n=-Math.min(e/100*360,359.999),r=Array.from(t.children),i=r[0];i&&"circle"===i.tagName&&i.setAttribute("fill",u);for(let e=r.length-2;e>=1;e--)t.removeChild(r[e]);if(e>0)if(e>=99.5){const e=document.createElementNS(y,"circle");e.setAttribute("cx",A.toFixed(2)),e.setAttribute("cy",A.toFixed(2)),e.setAttribute("r",(w-3).toFixed(2)),e.setAttribute("fill",c),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild)}else{const e=document.createElementNS(y,"path");e.setAttribute("d",C(A,A,w-3,-90,n)),e.setAttribute("fill",c),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild);const r=document.createElementNS(y,"path");r.setAttribute("d",k(A,A,w-3,-90,n)),r.setAttribute("fill","none"),r.setAttribute("stroke",c),r.setAttribute("stroke-width","3.5"),t.insertBefore(r,t.lastChild)}}}if(s){const t=Array.from(s.children);let e=r.showUtilizationText?0:-1,n=r.showUtilizationText?1:0;if(r.showUtilizationText&&e>=0&&t[e]){const n=t[e];n.textContent!==m&&(n.textContent=m)}if(t[n]){const e=t[n];e.textContent!==i&&(e.textContent=i)}}g.push({element:E,geometry:n,data:e});continue}E=document.createElement("div"),E.className="parking-lot-map-label",E.setAttribute("role","img"),E.setAttribute("aria-label",`${i}: ${p}`),E.setAttribute("tabindex","-1"),E.setAttribute("data-parking-lot-id",M),E.style.cssText=`\n        position: absolute;\n        left: ${N.x-50}px;\n        top: ${N.y-30}px;\n        background: white;\n        border-radius: 12px;\n        padding: 8px 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        border: 1px solid #d0d0d0;\n        font-family: 'Avenir Next', 'Helvetica Neue', Arial, sans-serif;\n        z-index: 1000;\n        pointer-events: none;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        min-width: 150px;\n      `;const z=document.createElement("div");z.style.cssText="\n        position: absolute;\n        bottom: -8px;\n        left: 20px;\n        width: 0;\n        height: 0;\n        border-left: 8px solid transparent;\n        border-right: 8px solid transparent;\n        border-top: 8px solid white;\n        z-index: 1001;\n      ";const R=document.createElement("div");R.style.cssText="\n        position: absolute;\n        bottom: -9px;\n        left: 20px;\n        width: 0;\n        height: 0;\n        border-left: 9px solid transparent;\n        border-right: 9px solid transparent;\n        border-top: 9px solid #d0d0d0;\n        z-index: 1000;\n      ";const T=D(S,c,u),I=document.createElement("div");if(I.style.cssText="\n        display: flex;\n        flex-direction: column;\n        gap: 1px;\n      ",r.showUtilizationText){const t=document.createElement("div");t.textContent=m,t.style.cssText="\n          font-size: 16px;\n          color: #000000;\n          line-height: 1.2;\n          font-weight: 900;\n        ",I.appendChild(t)}const P=document.createElement("div");P.textContent=i,P.style.cssText="\n        font-size: 13px;\n        font-weight: 700;\n        color: #000000;\n        line-height: 1.2;\n      ",I.appendChild(P),E.appendChild(T),E.appendChild(I),E.appendChild(R),E.appendChild(z);E.childNodes.length;if(F)try{d.appendChild(E)}catch(t){continue}else E.childNodes.length,I.textContent;g.push({element:E,geometry:n,data:e})}x.forEach(((t,e)=>{h.has(e)||t.parentNode&&t.parentNode.removeChild(t)}));d.querySelectorAll(".parking-lot-map-label").length;g.length,g.filter((t=>!x.has(t.element.getAttribute("data-parking-lot-id")||""))).length,g.filter((t=>x.has(t.element.getAttribute("data-parking-lot-id")||""))).length,d&&d.tagName,e.length,S.current=g,u(g)})),G=t=>b(void 0,void 0,void 0,(function*(){if(null==t||t.length,!d||!l)return;const e=d.querySelectorAll(".parking-lot-map-label"),n=new Map,i=new Set;e.forEach((t=>{const e=t.getAttribute("data-parking-lot-id");e&&n.set(e,t)})),n.size,t.length;for(const e of t){let t,o=null;if("function"==typeof e.getData){t=e.getData();try{if("function"==typeof e.getJSAPIGeometry)o=e.getJSAPIGeometry();else if("function"==typeof e.getGeometry){const t=e.getGeometry();t&&(o=t)}}catch(t){continue}}else e.attributes&&e.geometry?(t=e.attributes,o=e.geometry):(t=e.data||e.attributes||e,o=e.geometry||e.geom||null);const a=null==t?void 0:t[r.parkingLotField],s=null==t?void 0:t[r.utilizationField];if(!o||!a)continue;const c=String(a);i.add(c);const u=n.get(c);if(!u)continue;const d=Number(s),p=Number.isFinite(d)?d:0,f=r.availableColor||"#E683DD",m=r.unavailableColor||"#8B8B8B",h=j(p),g=r.showUtilizationText?h:"";let x=100-p;!r.allowNegatives&&x<0&&(x=0);const v=Math.max(0,Math.min(100,x));try{const t=l.view.toScreen(o),e=t.x-50+"px",n=t.y-30+"px";u.style.left!==e&&(u.style.left=e),u.style.top!==n&&(u.style.top=n)}catch(t){}u.setAttribute("aria-label",`${a}: ${h}`);const b=Array.from(u.children),S=b[0],M=b[1];if(S){const t=S.querySelector("svg");if(t){const e=Math.max(0,Math.min(100,v)),n=Math.min(e/100*360,359.999),r=Array.from(t.children),i=r[0];i&&"circle"===i.tagName&&i.setAttribute("fill",m);for(let e=r.length-2;e>=1;e--)t.removeChild(r[e]);if(e>0)if(e>=99.5){const e=document.createElementNS(y,"circle");e.setAttribute("cx",A.toFixed(2)),e.setAttribute("cy",A.toFixed(2)),e.setAttribute("r",(w-3).toFixed(2)),e.setAttribute("fill",f),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild)}else{const e=document.createElementNS(y,"path");e.setAttribute("d",C(A,A,w-3,-90,n)),e.setAttribute("fill",f),e.setAttribute("stroke","none"),t.insertBefore(e,t.lastChild);const r=document.createElementNS(y,"path");r.setAttribute("d",k(A,A,w-3,-90,n)),r.setAttribute("fill","none"),r.setAttribute("stroke",f),r.setAttribute("stroke-width","3.5"),t.insertBefore(r,t.lastChild)}}}if(M){const t=Array.from(M.children);let e=r.showUtilizationText?0:-1,n=r.showUtilizationText?1:0;if(r.showUtilizationText&&e>=0&&t[e]){const n=t[e];n.textContent!==g&&(n.textContent=g)}if(t[n]){const e=t[n];e.textContent!==a&&(e.textContent=a)}}}n.forEach(((t,e)=>{i.has(e)||t.parentNode&&t.parentNode.removeChild(t)})),i.size,n.size,i.size}));return(0,t.jsx)("div",{className:"parking-lot-widget jimu-widget","data-widget-id":i,style:{width:"100%",height:"100%",overflow:"hidden",position:"relative"}},a&&a.length>0&&(0,t.jsx)(e.JimuMapViewComponent,{useMapWidgetId:a[0],onActiveViewChange:t=>{if(t){s(t);let e=document.querySelector(`[data-widget-id="${null==a?void 0:a[0]}"] .map-root`);if(e||(e=document.querySelector(`[data-widget-id="${null==a?void 0:a[0]}"] .esri-view`),e||(e=document.querySelector(`[data-widget-id="${null==a?void 0:a[0]}"] .esri-view-root`)),e||(e=document.querySelector(`[data-widget-id="${null==a?void 0:a[0]}"]`))),e)p(e);else{const t=document.querySelector(".esri-view-root");t&&p(t)}}}}),o&&o.length>0&&d?(0,t.jsx)(t.DataSourceComponent,{useDataSource:o[0],widgetId:i,query:{},onDataSourceInfoChange:(t,e)=>{if(t&&void 0!==t.sourceVersion){const n=e&&t.sourceVersion!==e.sourceVersion,r=F.current!==t.sourceVersion;(n||null===F.current)&&r&&(F.current=t.sourceVersion,I())}}},(t=>{var e,n;return null===(e=null==t?void 0:t.getStatus)||void 0===e||e.call(t),null===(n=null==o?void 0:o[0])||void 0===n||n.dataSourceId,t?(x.current=t,t.id,t.type,t.getStatus(),null):(x.current=null,null)})):null,a&&0!==a.length?o&&0!==o.length?null:(0,t.jsx)("div",{className:"no-data"},(0,t.jsx)(t.FormattedMessage,{id:"configureDataSource",defaultMessage:v})):(0,t.jsx)("div",{className:"no-data"},(0,t.jsx)(t.FormattedMessage,{id:"selectMap",defaultMessage:"Please select a map widget in the settings"})))};function N(t){i.p=t}})(),o})())}}}));